"use strict";const sortOrder=",;'rxhgkqwfbpmzsdtnvjieoua";function compareBySatu(e,t){for(let r=0;;r++){const n=e.charAt(r),o=t.charAt(r);if(""===n)return-1;if(""===o)return 1;const l=sortOrder.indexOf(n),a=sortOrder.indexOf(o);if(n!==o)return a-l}}function satuToSound(e){return e.replaceAll("q","ŋ").replaceAll("f","ɸ").replaceAll("sj","ʃ").replaceAll("tj","tʃ").replaceAll("dj","dʒ").replaceAll("si","ʃi").replaceAll("v","əm").replaceAll("r","ɾ").replaceAll("x","ɣ")}const loadDictionary=async()=>{const e=document.getElementById("template_word");if(!(e instanceof HTMLTemplateElement))return;const t=e.parentElement;if(!t)return;const r=await fetch("./dictionary.csv"),n=(await r.text()).split("\n").map(e=>e.split(","));n.sort((e,t)=>compareBySatu(e[0]??"",t[0]??""));const o=/\{(.+?)\}/g;for(const r of n){const n=r[0]??"",l=r[1]??"",a=r[2]??"",c=r[3]??"",s=(r[4]??"").replaceAll(o,"<a href='#$1' class='satu'>$1</a>"),i=r[5]??"",d=r[6]??"",u=r[7]??"",p=r[8]??"",f=e.content.cloneNode(!0),m=f.querySelector("summary");m&&(m.querySelector("a")?.setAttribute("id",n),m.querySelector(".satu").textContent=n,m.querySelector(".dict-sound").textContent=`/${satuToSound(n)}/`,m.querySelector(".dict-mean").textContent=c);const h=f.querySelector("p");if(h){let e="0"===a?`【${l}語】 ${s}<br />`:`【${a}-${l}語】 ${s}<br />`,t="";if(""!==i&&(t+=`【名】${i}`),""!==d){""!==t&&(t+=" ");let e="動";"●"===u&&(e+="|飾"),"●"===p&&(e+="|接"),t+=`【${e}】${d}`}""!==u&&"●"!==u&&(""!==t&&(t+=" "),t+=`【${""===d&&"●"===p?"飾|接":"飾"}】${u}`),""!==p&&"●"!==p&&(""!==t&&(t+=" "),t+=`【接】${p}`),h.innerHTML=e+t}t.appendChild(f)}};window.addEventListener("load",loadDictionary),window.addEventListener("hashchange",e=>{console.log("HashChanged");const t=location.hash.replace("#",""),r=document.querySelector(`details:has(a#${t})`);r&&r.setAttribute("open","open");const n=document.getElementById(t);n&&n.scrollIntoView({block:"start",behavior:"smooth"}),e.preventDefault()});