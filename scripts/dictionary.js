"use strict";const sortOrder="#,;'xzwrhsfgdbktpqnmvyieoua";function compareBySatu(e,t){for(let r=0;;r++){const n=e.charAt(r),l=t.charAt(r);if(""===n)return-1;if(""===l)return 1;const o=sortOrder.indexOf(n),a=sortOrder.indexOf(l);if(o!==a)return a-o}}function satuToSound(e){return e.replaceAll("q","ŋ").replaceAll("f","ɸ").replaceAll("sy","ʃ").replaceAll("ty","tʃ").replaceAll("dy","dʒ").replaceAll("si","ʃi").replaceAll("y","j").replaceAll("v","əm").replaceAll("r","ɾ").replaceAll("x","ɣ").replaceAll("h","x")}const loadDictionary=async()=>{const e=document.getElementById("template_word");if(!(e instanceof HTMLTemplateElement))return;const t=e.parentElement;if(!t)return;const r=await fetch("./dictionary.csv"),n=(await r.text()).split("\n").map(e=>e.split(","));n.sort((e,t)=>compareBySatu(e[0]??"",t[0]??""));const l=/\{(.+?)\}/g;for(const r of n){const n=r[0]??"",o=r[1]??"",a=r[2]??"",c=r[3]??"",s=(r[4]??"").replaceAll(l,"<a href='#$1' class='satu'>$1</a>"),i=r[5]??"",d=r[6]??"",u=r[7]??"",p=r[8]??"",y=e.content.cloneNode(!0),f=y.querySelector("summary");f&&(f.querySelector("a")?.setAttribute("id",n),f.querySelector(".satu").textContent=n,f.querySelector(".dict-sound").textContent=`/${satuToSound(n)}/`,f.querySelector(".dict-mean").textContent=c);const m=y.querySelector("p");if(m){let e="0"===a?`【${o}語】 ${s}<br />`:`【${o}語-${a}】 ${s}<br />`,t="";if(""!==i&&(t+=`【名】${i}`),""!==d){""!==t&&(t+=" ");let e="動";"●"===u&&(e+="|飾"),"●"===p&&(e+="|接"),t+=`【${e}】${d}`}""!==u&&"●"!==u&&(""!==t&&(t+=" "),t+=`【${""===d&&"●"===p?"飾|接":"飾"}】${u}`),""!==p&&"●"!==p&&(""!==t&&(t+=" "),t+=`【接】${p}`),m.innerHTML=e+t}t.appendChild(y)}};window.addEventListener("load",loadDictionary),window.addEventListener("hashchange",e=>{console.log("HashChanged");const t=location.hash.replace("#",""),r=document.querySelector(`details:has(a#${t})`);r&&r.setAttribute("open","open");const n=document.getElementById(t);n&&n.scrollIntoView({block:"start",behavior:"smooth"}),e.preventDefault()});